# FlowForge Build Files

This document describes the optimized build scripts and files in the `scripts/` directory.

## Flatpak Manifests (YML)

1. **io.github.flowforge.FlowForge.yml** - Main production manifest
   - Complete Flatpak package definition
   - Includes MongoDB, Node.js backend, React frontend, and Electron wrapper
   - Proper sandboxing permissions and desktop integration

2. **io.github.flowforge.FlowForge.devel.yml** - Development manifest
   - Simplified version for testing
   - Mock services instead of real MongoDB
   - No API key requirements

3. **io.github.flowforge.FlowForge.online.yml** - Online build manifest
   - Attempts to build with network access
   - Alternative approach for simpler builds

4. **io.github.flowforge.FlowForge.simple.yml** - Simplified manifest
   - Generated by build-flatpak-simple.sh
   - Basic build configuration

## Build Scripts

5. **build-flatpak.sh** - Main production build script
   - Automates the entire build process
   - Options: --install, --run, --export
   - Handles offline dependency generation
   - Uses flatpak-node-generator.py

6. **build-flatpak-simple.sh** - Simplified builder
   - Creates basic Flatpak without offline sources
   - Faster build for development
   - Network access required

7. **build-flatpak-dev.sh** - Development builder
   - Builds application locally
   - Creates flatpak-build/ directory
   - No Flatpak infrastructure required

8. **package-flowforge.sh** - Distribution packager
   - Creates tar.gz distribution package
   - Includes installer script
   - Alternative to Flatpak distribution

9. **create-flatpak-bundle.sh** - Bundle creator
   - Exports Flatpak to repository
   - Creates distributable .flatpak file
   - For sharing pre-built packages

10. **create-bundle.sh** - Simple bundle script
    - Quick bundle creation
    - Auto-generated by build script

## Helper Scripts

11. **flatpak-node-generator.py** - NPM source generator
    - Converts package-lock.json to Flatpak sources
    - Required for offline builds
    - Handles base64 encoding issues

12. **setup-config.sh** - Configuration helper
    - Interactive API key configuration
    - Creates .env file in Flatpak data directory
    - Post-installation setup

13. **validate-environment.sh** - Environment checker
    - Validates build prerequisites
    - Checks for required tools and runtimes
    - Provides clear error/warning messages

14. **install-runtimes.sh** - Runtime installer
    - Installs all required Flatpak runtimes
    - Adds Flathub repository if needed
    - One-command runtime setup

15. **test-flatpak.sh** - Test environment script
    - Creates minimal test Flatpak
    - Validates basic functionality
    - Quick sanity check

## Generated Files (JSON)

16. **generated-sources-backend.json** - Backend npm sources
    - Generated from backend/package-lock.json
    - Contains 514 npm packages
    - Required for offline builds

17. **generated-sources-frontend.json** - Frontend npm sources
    - Generated from frontend/package-lock.json
    - Contains 515 npm packages
    - Required for offline builds

18. **flowforge-electron-sources.json** - Electron sources
    - Generated for Electron wrapper
    - Contains 70 npm packages
    - Required for desktop integration

## Reference Files

19. **flatpak-readme.md** - Original Flatpak documentation
    - Comprehensive guide for Flatpak distribution
    - Reference material from initial planning

20. **flatpak-build-scripts.sh** - Original build script reference
    - Example script from planning phase
    - Shows intended build process

21. **flatpak-test-script.sh** - Original test script reference
    - Example testing approach
    - Reference for validation

22. **flowforge-flatpak.txt** - Original manifest template
    - Complete manifest example
    - Reference for structure

23. **FLATPAK-SUMMARY.md** - Previous summary document
    - Earlier documentation of file structure
    - Now superseded by this file

## Usage

### Quick Build Commands

```bash
# Validate environment
./scripts/validate-environment.sh

# Install runtimes
./scripts/install-runtimes.sh

# Build Flatpak (main method - requires fixing offline sources)
./scripts/build-flatpak.sh --install --run

# Alternative: Create distribution package
./scripts/package-flowforge.sh

# The package creates: flowforge-0.2.0-linux-x64.tar.gz
```

### File Locations

All Flatpak-related files are now in the `scripts/` directory. The main documentation has been moved to `docs/FLATPAK-BUILD.md`.

### Path Updates

All scripts have been updated to use relative paths:
- `SCRIPT_DIR` for the scripts directory
- `PROJECT_ROOT` for the main project directory
- JSON files are referenced without path prefixes in manifests
- All build outputs go to the project root directory

## Notes

- The Flatpak build environment restricts network access, requiring offline npm sources
- The package-flowforge.sh script creates a working distribution without Flatpak
- Generated JSON files should be regenerated when dependencies change
- All scripts are executable (chmod +x)